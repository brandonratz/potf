!function e(t,n,r){function o(i,s){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return o(n?n:e)},c,c.exports,e,t,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t){!function(){angular.module("myApp",["ngRoute","ngMock"]).controller("PasswordController",function(e){e.password="",e.grade=function(){var t=e.password.length;e.strength=t>8?"strong":t>3?"medium":"weak"}}).config(["$routeProvider",function(e){e.when("/",{templateUrl:"partials/home.html",controller:"HomeCtrl",controllerAs:"home"}).when("/error",{templateUrl:"partials/error.html",controller:"ErrorCtrl",controllerAs:"error"}).when("/lots/:_id/:start/:end",{templateUrl:"partials/lot.html",controller:"LotCtrl",controllerAs:"lot"}).when("/reservations",{templateUrl:"partials/reservations.html",controller:"ReservationsCtrl",controllerAs:"reservations"}).when("/help",{templateUrl:"partials/help.html",controller:"ReservationsCtrl",controllerAs:"reservations"}).when("/logout",{templateUrl:"partials/home.html",controller:"HomeCtrl",controllerAs:"home"}).otherwise({redirectTo:"/"})}])}(),function(){angular.module("myApp").controller("ErrorCtrl",["$window",function(e){this.reloadApplication=function(){e.location.href="/"}}])}(),function(){angular.module("myApp").controller("HomeCtrl",["$timeout","$window","homeState","navigator","search",function(e,t,n,r,o){function a(){for(var e=0;e<c.length;e++)t.google.maps.event.clearInstanceListeners(c[e]),c[e].setMap(null)}function i(){a(),t.google.maps.event.clearInstanceListeners(n.map),t.document.getElementById("map-container").style.visibility="hidden"}function s(){a();var s=n.map.getBounds().getNorthEast(),l=n.map.getBounds().getSouthWest(),u=o.getDistanceFromLatLonInKm(s.lat(),s.lng(),l.lat(),l.lng());o.search({lat:n.map.getCenter().lat(),lng:n.map.getCenter().lng(),dia:u,start:n.searchWindow.start.getTime(),end:n.searchWindow.end.getTime()}).then(function(o){for(var a=0;a<o.length;a++)!function(o){var a="assets/img/available.png";0===o.available&&(a="assets/img/unavailable.png");var s=new t.google.maps.Marker({position:{lat:o.lat,lng:o.lng},map:n.map,icon:a});0!==o.available&&t.google.maps.event.addListener(s,"click",function(){i(),e(function(){r.navigate("/lots/"+o._id+"/"+n.searchWindow.start.getTime()+"/"+n.searchWindow.end.getTime())})}),c.push(s)}(o[a])}).catch(function(){i(),r.navigate("/error")})}var l=this;l.menuOpen=!1,l.timeOpen=!1,l.searchDateInput=new Date(n.searchWindow.start.getFullYear(),n.searchWindow.start.getMonth(),n.searchWindow.start.getDate()),l.searchHoursInput=n.searchWindow.start.getHours();var c=[];l.navigateReservations=function(){i(),r.navigate("/reservations")},l.help=function(){i(),r.navigate("/help")},l.searchUpdate=function(){l.timeOpen=!1,n.searchWindow.start=new Date(l.searchDateInput.getTime()+60*l.searchHoursInput*60*1e3),n.searchWindow.end=new Date(n.searchWindow.start.getTime()+864e5),s()},t.google.maps.event.addListener(n.map,"idle",function(){n.mapReady=!0,s()}),t.document.getElementById("map-container").style.visibility="visible",n.mapReady&&s()}])}(),function(){angular.module("myApp").controller("LotCtrl",["$routeParams","Lots","navigator","Reservations",function(e,t,n,r){function o(){r.query({lot:e._id,active:"true"}).then(function(e){a.reservations=e}).catch(function(){n.navigate("/error")})}var a=this;a.reserved=!1,a.full=!1,a.reservations=[],a.navigate=n.navigate,a.start=e.start,a.end=e.end,t.get({_id:e._id}).then(function(e){a.lot=e}).catch(function(){n.navigate("/error")}),a.reserve=function(){var t=new r({lot:e._id,start:a.start,end:a.end});t.$save().then(function(){a.reserved=!0,o()}).catch(function(){a.full=!0,o()})},o()}])}(),function(){angular.module("myApp").controller("ReservationsCtrl",["navigator","Reservations","$scope",function(e,t,n){var r=this;r.all=!1,r.navigate=e.navigate,r.reservations=[];var o=new Date;r.now=o.getTime(),t.query({active:"true"}).then(function(e){r.reservations=e}).catch(function(){e.navigate("/error")}),r.showAll=function(){console.log("test show"),r.all=!0,t.query().then(function(e){r.reservations=e,console.log(r.reservations)}).catch(function(){e.navigate("/error")})},r.cancel=function(e){console.log("test cenale"),console.log(r.reservations+"  "+e),delete r.reservations[e]},n.abc=14,n.password="",n.grade=function(){var e=n.password.length;n.strength=e>8?"strong":e>3?"medium":"weak"}}])}(),describe("ReservationsCtrl",function(){beforeEach(t("myApp"));var e;beforeEach(inject(function(t){e=t})),describe("$scope.grade",function(){it('sets the strength to "strong" if the password length is >8 chars',function(){{var t={};e("ReservationsCtrl",{$scope:t})}t.password="longerthaneightchars",t.grade(),expect(t.strength).toEqual("strong"),expect(t.abc).toEqual(14)})})}),function(){angular.module("myApp").directive("confirmationNeeded",function(){return{priority:1,terminal:!0,link:function(e,t,n){var r=n.confirmationNeeded||"Are you sure you want to delete this item?",o=n.ngClick;t.bind("click",function(){window.confirm(r)&&e.$eval(o)})}}})}(),function(){angular.module("myApp").directive("screenHeading",function(){return{restrict:"A",templateUrl:"partials/screenHeading.html",scope:{centerName:"@",leftName:"@",leftIcon:"@",leftFunction:"&",rightName:"@",rightIcon:"@",rightFunction:"&"},bindToController:!0,controllerAs:"screenHeading",controller:function(){}}})}(),function(){angular.module("myApp").factory("Lots",["$q",function(e){var t=function(){};return t.lots=[{_id:"a",name:"Regency Oaks Parking",description:"Regency Oaks Parking",lat:29.629291,lng:-82.371552,spaces:23,buffer:2},{_id:"a1",name:"Regency Oaks Parking1",description:"Regency Oaks Parking1",lat:29.729291,lng:-82.771552,spaces:23,buffer:2},{_id:"a2",name:"Regency Oaks Parking2",description:"Regency Oaks Parking2",lat:29.029291,lng:-82.071552,spaces:23,buffer:2},{_id:"b",name:"24/7 Parking Spaces at Country Gardens by Shands",description:"24/7 Parking Spaces at Country Gardens by Shands",lat:29.633865,lng:-82.342722,spaces:5,buffer:1}],t.get=function(n){var r=e.defer(),o=n._id;if(void 0!==o){var a=t.lots.map(function(e){return e._id}).indexOf(o);-1!==a?r.resolve(t.lots[a]):r.reject()}else r.reject();return r.promise},t}])}(),function(){angular.module("myApp").factory("Reservations",["$filter","$q","Lots",function(e,t,n){var r=function(e){var o=this;o.lot=e.lot,o.start=e.start,o.end=e.end,o.$save=function(){for(var e=t.defer(),a=n.lots[n.lots.map(function(e){return e._id}).indexOf(o.lot)],i=0,s=0;s<r.reservations.length;s++)r.reservations[s].start<o.end&&r.reservations[s].end>o.start&&i++;if(a.spaces-a.buffer-i>0){var l=new Date;o._id="r"+l.getTime(),r.reservations.push({_id:o._id,lot:o.lot,start:o.start,end:o.end}),e.resolve()}else e.reject(409);return e.promise}};return r.reservations=[{_id:"r1",lot:"b1",start:1433950325e3,end:1433951328e3},{_id:"r2",lot:"b2",start:1433950325,end:1433950325},{_id:"r3",lot:"b3",start:1433950325,end:1433950325}],r.query=function(n){var o=t.defer(),a=new Date,i=a.getTime();if(n&&n.lot)s=e("filter")(r.reservations,{lot:n.lot},!0);else var s=r.reservations;return n&&"true"===n.active?o.resolve(e("filter")(s,function(e){return e.end>i})):o.resolve(s),o.promise},r}])}(),function(){angular.module("myApp").factory("homeState",["$window",function(e){var t={mapReady:!1,searchWindow:{}},n=new Date;t.searchWindow.start=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours()),t.searchWindow.end=new Date(t.searchWindow.start.getTime()+864e5);var r={center:{lat:29.6316144,lng:-82.3595472},zoom:13,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{style:e.google.maps.ZoomControlStyle.DEFAULT,position:e.google.maps.ControlPosition.BOTTOM_LEFT},scaleControl:!0};return t.map=new e.google.maps.Map(e.document.getElementById("map-container"),r),t}])}(),function(){angular.module("myApp").factory("navigator",["$location",function(e){var t={current:"/"};return t.navigate=function(n){t.current=n,e.path(n)},t}]).run(["navigator","$location","$rootScope",function(e,t,n){"/"!=t.path()&&t.path("/"),n.$on("$locationChangeStart",function(t,n){var r=n.substring(n.search("#")+1);r!=e.current&&t.preventDefault()})}])}(),function(){function e(e){return e*(Math.PI/180)}var t=/^\d+$/,n=/^-*\d+\.?\d*|-*\.\d+/;angular.module("myApp").factory("search",["$q","Lots","Reservations",function(r,o,a){var i={};return i.getDistanceFromLatLonInKm=function(t,n,r,o){var a=6371,i=e(r-t),s=e(o-n),l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(e(t))*Math.cos(e(r))*Math.sin(s/2)*Math.sin(s/2),c=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),u=a*c;return u},i.search=function(e){var s=r.defer(),l=e.lat,c=e.lng,u=e.dia,d=e.start,g=e.end;if(void 0!==l&&void 0!==c&&void 0!==d&&void 0!==g&&n.test(l)&&n.test(c)&&t.test(d)&&t.test(g)&&parseInt(d)<parseInt(g)){for(var f=[],p=0;p<o.lots.length;p++)if(i.getDistanceFromLatLonInKm(l,c,o.lots[p].lat,o.lots[p].lng)<u/2){for(var m=0,v=0;v<a.reservations.length;v++)a.reservations[v].lot===o.lots[p]._id&&a.reservations[v].start<g&&a.reservations[v].end>d&&m++;f.push({_id:o.lots[p]._id,lat:o.lots[p].lat,lng:o.lots[p].lng,available:o.lots[p].spaces-o.lots[p].buffer-m})}s.resolve(f)}else s.reject();return s.promise},i}])}()},{}]},{},[1]);